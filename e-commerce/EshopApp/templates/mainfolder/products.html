{% extends "mainfolder/base.html" %}
{% load custom_filters %}
    {% load static %}
    {% block body %}
    {% include 'mainfolder/carsual.html' %}
        <!-- Fruits Shop Start-->
        <div class="container-fluid fruite">
            <div class="container">
                <h1 class="mb-4">Shop the Best Deals</h1>
                <div class="row g-4">
                    <div class="col-lg-12">
                        <div class="row g-4">
                            <div class="col-lg-3">
                                <div class="row g-4">
                                    <div class="col-lg-12">
                                        <div class="mb-3">
                                            <h4>Categories</h4>
                                            <ul class="list-unstyled fruite-categorie">
                                                <li>
                                                    <div class="d-flex justify-content-between fruite-name">
                                                        <a href="{% url 'products' %}" class="{% if not selected_category %}fw-bold text-primary{% endif %}">
                                                            <i class="fas fa-list me-2"></i>All
                                                        </a>
                                                        <span>({{ products.paginator.count }})</span>
                                                    </div>
                                                </li>
                                                {% for category in categories %}
                                                <li>
                                                    <div class="d-flex justify-content-between fruite-name">
                                                        <a href="?category={{ category.id }}" class="{% if selected_category == category.id %}fw-bold text-primary{% endif %}">
                                                            <i class="fas fa-apple-alt me-2"></i>{{ category.name }}
                                                        </a>
                                                    </div>
                                                </li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <div class="mb-3">
                                            <h4 class="mb-2">Price</h4>
                                            <input type="range" class="form-range w-100" id="rangeInput" name="rangeInput" min="0" max="500" value="0" oninput="amount.value=rangeInput.value">
                                            <output id="amount" name="amount" min-velue="0" max-value="500" for="rangeInput">0</output>
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <h4 class="mb-3">Featured products</h4>
                                        {% for featured in featured_products %}
                                        <div class="d-flex align-items-center justify-content-start">
                                            <div class="rounded me-4" style="width: 100px; height: 100px;">
                                                {% if featured.image %}
                                                <img src="{{ featured.image.url }}"class="img-fluid rounded"  alt="{{ featured.name }}">
                                                {% else %}
                                                <img src="{% static 'img/default-item.png' %}" alt="No image available" class="img-fluid rounded">
                                                {% endif %}
                                            </div>
                                            <div>
                                                <h6 class="mb-2">
                                                    <a href="/product-detail/{{ featured.id }}/" class="text-decoration-none text-dark">
                                                        {{ featured.name }}
                                                    </a>
                                                </h6>
                                                <div class="d-flex mb-2">
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star text-secondary"></i>
                                                    <i class="fa fa-star"></i>
                                                </div>
                                                <div class="d-flex align-items-center mb-2">
                                                    <strong class="text-success fw-bold me-2">₹ {{ featured.id|applydiscount }}</strong>
                                                    <strong class="text-danger text-decoration-line-through">₹ {{ featured.price }}</strong>
                                                </div>
                                            </div>
                                        </div>
                                        {% endfor %}
                                        <div class="d-flex justify-content-center my-4">
                                            <a href="{% url 'home' %}" class="btn border border-secondary px-4 py-3 rounded-pill text-primary w-100">Vew More</a>
                                        </div>
                                    </div>
                                    <div class="col-lg-12">
                                        <div class="position-relative">
                                            <img src="{% static 'img/banner-fruits.jpg' %}" class="img-fluid w-100 rounded" alt="">
                                            <div class="position-absolute" style="top: 50%; right: 10px; transform: translateY(-50%);">
                                                <h3 class="text-secondary fw-bold">Fresh <br> Fruits <br> Banner</h3>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--Here Product item display-->
                            <div class="col-lg-9">
                                <div class="row g-4 justify-content-center">
                                {% if products %}
                                    {% for prod in products %}
                                    <div class="col-md-6 col-lg-6 col-xl-6 d-flex">
                                         <div class="rounded shadow-sm position-relative fruite-item d-flex flex-column bg-white">
                                            <div class="fruite-img" style="height:220px;">
                                            {% if prod.image %}
                                                <img src="{{ prod.image.url }}" class="img-fluid rounded-top" alt="{{ prod.name }}">
                                             {% else %}
                                                <img src="{% static 'img/fruite-item-5.jpg' %}" class="img-fluid w-100 rounded-top" alt="Default Product">
                                             {% endif %}
                                            </div>
                                            <div class="text-white bg-secondary px-3 py-1 rounded position-absolute" style="top: 10px; left: 10px;">
                                                {{prod.category}}
                                            </div>
                                            <div class="p-4 border border-secondary border-top-0 rounded-bottom mt-auto">
                                                <h4 class="fw-bold fs-5 text-dark">{{ prod.name }}</h4>
                                                <p>{{ prod.description|truncatewords:10 }}</p>
                                                <p class="text-dark fs-5 fw-bold mb-0 py-2">
                                                    <strong>Price:</strong>
                                                        <span class="text-muted text-decoration-line-through me-2">₹ {{ prod.price }}</span>
                                                        <span class="text-success fw-bold">₹ {{ prod.id|applydiscount }}</span> </p>
                                                <div class="d-flex justify-content-between flex-lg-wrap">
                                                <a href="/add-to-cart/{{prod.id}}/" class="btn border border-secondary rounded-pill px-3 py-1 mb-4 text-primary"><i class="fa fa-shopping-bag me-2 text-primary"></i> Add to cart</a>
                                                <a href="/product-detail/{{prod.id}}/" class="btn border border-secondary rounded-pill px-3 py-1 mb-4 text-primary"><i class="fa fa-eye me-2 text-primary"></i>View More</a>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}  
                                {% else %}
                                <div class="card rounded-3 mb-4">
                                    <div class="card-body p-4">
                                        <div class="row d-flex justify-content-center align-items-center py-5">
                                            <div class="alert alert-warning text-center shadow-lg p-4 rounded" role="alert" style="max-width: 500px;">
                                                <i class="fas fa-exclamation-triangle fa-2x text-danger mb-3"></i>
                                                <h5 class="text-danger mb-2">Item Not Available</h5>
                                                <p class="mb-0">Sorry, no items are currently available in this category.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% endif %}
                                   <!-- Pagination (only shown if products exist) -->
                                {% if products.has_other_pages %}
                                <div class="col-12">
                                    <div class="pagination d-flex justify-content-center mt-5">
                                        {% if products.has_previous %}
                                            <a href="?{% if selected_category %}category={{ selected_category }}&{% endif %}page={{ products.previous_page_number }}" class="rounded">&laquo;</a>
                                        {% endif %}
                                        {% for page_num in products.paginator.page_range %}
                                            <a href="?{% if selected_category %}category={{ selected_category }}&{% endif %}page={{ page_num }}" class="rounded {% if products.number == page_num %}active{% endif %}">
                                                {{ page_num }}
                                            </a>
                                        {% endfor %}
                                        {% if products.has_next %}
                                            <a href="?{% if selected_category %}category={{ selected_category }}&{% endif %}page={{ products.next_page_number }}" class="rounded">&raquo;</a>
                                        {% endif %}
                                    </div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Fruits Shop End-->
    {% endblock %}    


       